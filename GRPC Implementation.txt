import com.amazonaws.auth.AWSStaticCredentialsProvider;
import com.amazonaws.auth.BasicAWSCredentials;
import com.amazonaws.regions.Regions;
import com.amazonaws.services.cognitoidp.AWSCognitoIdentityProvider;
import com.amazonaws.services.cognitoidp.AWSCognitoIdentityProviderClientBuilder;
import com.amazonaws.services.cognitoidp.model.AdminInitiateAuthRequest;
import com.amazonaws.services.cognitoidp.model.AdminInitiateAuthResult;
import com.amazonaws.services.cognitoidp.model.AuthFlowType;
import com.amazonaws.services.cognitoidp.model.AdminInitiateAuthRequest;
import com.amazonaws.services.cognitoidp.model.AdminInitiateAuthResult;

import java.util.HashMap;
import java.util.Map;

public class CognitoAuthExample {
    public static void main(String[] args) {
        // 1. Configurações Cognito
        String clientId = "seu-client-id";
        String userPoolId = "seu-user-pool-id";
        String accessKey = "sua-aws-access-key";  // Opcional se estiver usando credenciais configuradas no ambiente
        String secretKey = "sua-aws-secret-key";  // Opcional se estiver usando credenciais configuradas no ambiente

        // 2. Credenciais AWS (opcional se estiver utilizando credenciais configuradas)
        BasicAWSCredentials awsCreds = new BasicAWSCredentials(accessKey, secretKey);

        // 3. Inicializar o cliente Cognito
        AWSCognitoIdentityProvider cognitoClient = AWSCognitoIdentityProviderClientBuilder.standard()
                .withCredentials(new AWSStaticCredentialsProvider(awsCreds))
                .withRegion(Regions.US_EAST_1)  // Defina a região apropriada
                .build();

        // 4. Parâmetros de autenticação
        Map<String, String> authParams = new HashMap<>();
        authParams.put("USERNAME", "seu-username");
        authParams.put("PASSWORD", "sua-password");

        // 5. Construindo a solicitação de autenticação
        AdminInitiateAuthRequest authRequest = new AdminInitiateAuthRequest()
                .withUserPoolId(userPoolId)
                .withClientId(clientId)
                .withAuthFlow(AuthFlowType.ADMIN_NO_SRP_AUTH) // Fluxo sem SRP
                .withAuthParameters(authParams);

        // 6. Fazendo a chamada para autenticar o usuário
        AdminInitiateAuthResult authResult = cognitoClient.adminInitiateAuth(authRequest);

        // 7. Exibindo os tokens de autenticação
        System.out.println("ID Token: " + authResult.getAuthenticationResult().getIdToken());
        System.out.println("Access Token: " + authResult.getAuthenticationResult().getAccessToken());
        System.out.println("Refresh Token: " + authResult.getAuthenticationResult().getRefreshToken());
    }
}
